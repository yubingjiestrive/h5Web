<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <link rel="stylesheet" href="../css/bootstrap.css" />
    <link rel="stylesheet" href="../css/index.css">

    <title></title>
</head>
<body style="background-color: #FAFAFA">
   <div class=" navbar-fixed-top-detail">
       <ul class="detail-top">
           <li class="detail-active">商品</li>
           <li>评价</li>
           <li>详情</li>
           <li>推荐</li>
       </ul>
   </div>
   <div class="carousel1" id="f1">
       <ul>
           <li>
               <a href="javascript:;">
                   <img src="../image/0.png" alt="">
               </a>
           </li>
           <li>
               <a href="javascript:;">
                   <img src="../image/1.png" alt="">
               </a>
           </li>
           <li>
               <a href="javascript:;">
                   <img src="../image/2.png" alt="">
               </a>
           </li>
           <li>
               <a href="javascript:;">
                   <img src="../image/3.png" alt="">
               </a>
           </li>
           <li>
               <a href="javascript:;">
                   <img src="../image/4.png" alt="">
               </a>
           </li>
           <li>
               <a href="javascript:;">
                   <img src="../image/5.png" alt="">
               </a>
           </li>
           <li>
               <a href="javascript:;">
                   <img src="../image/6.png" alt="">
               </a>
           </li>
           <li>
               <a href="javascript:;">
                   <img src="../image/7.png" alt="">
               </a>
           </li>
       </ul>
       <span class="num">1/8</span>
   </div>
   <div class="detail-all">
       <span class="intor">HUAWEI Mate 10 Pro 6GB+64GB 全网通版（银钻灰）</span>
       <span class="price">¥ 4899<span>新品抢先价</span></span>
       <span class="priceOld">价格<span>¥5888</span> </span>
       <span class="fq">该商品最高可享12期分期</span>
   </div>
   <div class="buy">
       <div class="size">选择 颜色分类 内存<span class="glyphicon glyphicon-menu-right"></span></div>
       <div class="parameter">产品参数<span class="glyphicon glyphicon-menu-right"></span></div>
   </div>
 <div class="sizeIntor-bg">
     <div class="sizeIntor">
     <span class="close">X</span>
     <div class="img"><img src="../image/detail6.jpg" class="img-responsive">
     <span>
         <span>¥4999</span>
         <span>库存1222件</span>
         <span>选择 颜色分类 内存</span>
     </span>
 </div>

     <div class="color">
         <div>颜色分类</div>
         <span>金色</span>    <span>银色</span>
     </div>
     <div class="memory">
         <div>内存</div>
         <span>64GB</span>    <span>128GB</span>
     </div>
     <div class="purchase">
         <span>购买数量</span>
      <span class="pnum"> <span class="jian">-</span> <span class="inp">1</span> <span class="jia">+</span></span>
     </div>
     <div class="ok">
         确定
     </div>
 </div>
     </div>

   <div class="evaluate" id="f2">
           <div>用户评价</div>
           <span>很好很好</span>
           <span>很好很</span>
           <span>很好很</span>
           <span>很好很好</span>
           <span>好好</span>
           <span>好好</span>

       <div><img src="../image/pj.png" width="8%" height="8%">&nbsp;B***555</div>
       <p>买给爸爸的，见他用得很开心很好，没什么问题，看到他玩着这么开心，
           我也跟着一起开心，手感很不错，温润如玉，爱不释手 防尘防水
           值得购买</p>
   </div>

   <div class="detail" id="f3">
       <div>产品详情</div>
        <img src="../image/detail6.jpg" class="img-responsive">
       <img src="../image/details.jpg" class="img-responsive">
       <img src="../image/details1.jpg" class="img-responsive">
       <img src="../image/details2.jpg" class="img-responsive">
       <img src="../image/details3.jpg" class="img-responsive">
   </div>
   <div id="f4" class="tj">
       <div>推荐产品</div>
       <img src="../image/tj.png" class="img-responsive">
       <img src="../image/tj.png" class="img-responsive">
       <img src="../image/tj.png" class="img-responsive">
       <img src="../image/tj.png" class="img-responsive">
       <img src="../image/tj.png" class="img-responsive">
       <img src="../image/tj.png" class="img-responsive">
       <img src="../image/tj.png" class="img-responsive">
   </div>
   <div class="navbar-fixed-bottom b">
       <ul class="detail-bottom">
           <li>
               <a href="index.html"  >
                   <span class="glyphicon glyphicon-home s"> <span class="bottom-list">首页</span></span>
               </a>
           </li>
           <li>
               <a href="sort.html">
                   <span class="glyphicon glyphicon-shopping-cart s"><span class="bottom-list">购物车</span></span>
               </a>
           </li>
           <li class="cart" style="  color: #ffffff;"> 加入购物车</li>
           <li class="buyNow"  style="  color: #ffffff;"> 立即购买</li>
       </ul>
   </div>
   <script src="../js/jquery-1.11.3.js"></script>

   <script src="../js/bootstrap.js"></script>
<script src="../js/index.js"></script>
<script>
    $(function(){

            // 功能: 实现移动端轮播图
            // 步骤:
            // 1.获取元素div,ul,第一个li,最后一个li
        document.documentElement.style.fontSize =document.documentElement.clientWidth/3.75 + 'px';
        var carousel = document.querySelector('.carousel1');
        var ul = document.querySelector('.carousel1 ul');
        var firstLi = document.querySelector(".carousel1 ul li:first-child");
        var lastLi = document.querySelector('.carousel1 ul li:last-child');
        var num=document.querySelector('.num');
        var locked = false;
        var points = null;


        // 2.声明变量
        var carouselWidth = document.documentElement.clientWidth;//获取当前窗口的宽度
        var aLi, timer, startTx, endTx, index = 0;//startTx 手指滑动开始的x  endTx 结束的x

        // 3.初始化页面(给第一个li前面添加最后一个li,给最后一个li后面添加第一个li);
        function init() {

            ul.appendChild(firstLi.cloneNode(true));
            ul.insertBefore(lastLi.cloneNode(true), firstLi);

            // 4.获取所有li
            aLi = document.querySelectorAll(".carousel1 ul li");

            // 5.设置carousel ul li 的宽度
            setWidth();

            // 6.修正li的显示顺序(第一个应该是图片0,不是图片7)
            index--;
            ul.style.left = index * carouselWidth + 'px';

            // 7.自动轮播
            autoPlay();
        }


        // 8.监听检测ul的位移 防止出现空白 处理最后一张和一张
        ul.addEventListener('webkitTransitionEnd', function () {
            console.log(index);
            locked = false;

            // 如果索引为0;
            if (index == 0) {

                index = -8;
                console.log(index)

            }

            if (index <= -9) {
                index = -1;
            }

            ul.style.left = index * carouselWidth + 'px';
            ul.style.transition = "";

        })

        // 9.给轮播图添加手指滑动
        ul.addEventListener('touchstart', function (e) {
            // console.log(1);
            // 清除定时器
            clearInterval(timer);

            var touches = e.targetTouches[0];

            startTx = touches.clientX;
        })

        ul.addEventListener('touchend', function (e) {
            //  console.log(2);
            autoPlay();// autoplay()方法的位置问题
            console.log(locked);
            if (locked == true) {
                return false;
            }

            locked = true;

            var touches = e.changedTouches[0];

            endTx = touches.clientX;

            // 10.判断用户滑动的方式,改变轮播的索引

            if (endTx - startTx > 0) {
                // 向右滑
                index++;

            } else {
                // 向左滑
                index--;
            }
            ul.style.left = index * carouselWidth + 'px';
            ul.style.transition = "all 1s";

            //滑动时判断 index 去除首尾的重复图片
            num1();

        })

        //滑动时判断 index 去除首尾的重复图片
        function num1(){
            var index1=-index;//取正值
            if(index1==9){
                num.innerHTML='1/8';
            }
            else if(index1===0){
                num.innerHTML='8/8';
            }
            else{
                num.innerHTML=index1+'/8';
            }
        }
        function setWidth() {

            carousel.style.width = carouselWidth + 'px';//初始化容器的宽度=当前窗口的宽度

            ul.style.width = aLi.length * carouselWidth + 'px';//初始化ul的宽度

            for (var i = 0; i < aLi.length; i++) {

                aLi[i].style.width = carouselWidth + 'px';//赋值每个li的宽度
            }
        }

        function autoPlay() {
            timer = setInterval(function () {
                index--;
                ul.style.left = index * carouselWidth + 'px';
                ul.style.transition = "all 1s";
                num1();
            }, 2000);
        }

//     function changePoint() {
//       for(var i =0;i<points.length;i++){
//         points[i].classList.remove("active");
//       }
//       points[-(index)-1].classList.add("active");
//     }


        //窗口大小改变时触发 自动刷新页面一次 获取当前窗口大小
        window.onresize=function() {
            carouselWidth = document.documentElement.clientWidth;

            //窗口大小改变改变字体大小
            document.documentElement.style.fontSize =carouselWidth/3.75 + 'px';

            location.reload();

            init();
        }
        init();


        $(window).scroll(function(){
            for(var i=0;i<$('.detail-top li').length;i++){
//                if($(window).scrollTop()>=$('#f1').height()){
//                    $('.detail-top').fadeIn(300);
//                }else{
//                    $('.detail-top').fadeOut(300);
//                }
                if($(window).scrollTop()>=$('#f'+(i+1)).offset().top){
                    $('.detail-top li').eq(i).addClass('detail-active').siblings().removeClass('detail-active');
                }
                $('.detail-top li').click(function(){
                    console.log($(this).index());
                    $(window).scrollTop($('#f'+($(this).index()+1)).offset().top);
                    $(this).addClass('detail-active').siblings().removeClass('detail-active');
                })
            }
        });
        var i=$('.inp').html();
       $('.jian').click(function(){
       if(i<1){
           $(".inp").html("1");
       }
       else
       $('.inp').html(i--);
   });
        $('.jia').click(function(){

            $('.inp').html(i++);
        })
        $('.size').click(function(){
            $('.sizeIntor').animate({bottom:'0', opacity:'1'},300);
            $('.sizeIntor-bg').css('display','block');
        })
        $('.close').click(function(){
            $('.sizeIntor').animate({bottom:'-500px', opacity:'0'},300);
            $('.sizeIntor-bg').css('display','none');
        });
        $('.ok').click(function(){
            $('.sizeIntor').animate({bottom:'-500px', opacity:'0'},300);
            $('.sizeIntor-bg').css('display','none');
        });

        $('.parameter').click(function(){
            $('.sizeIntor').animate({bottom:'0', opacity:'1'},300);
            $('.sizeIntor-bg').css('display','block');
        });
        $('.cart').click(function(){
            $('.sizeIntor').animate({bottom:'0', opacity:'1'},300);
            $('.sizeIntor-bg').css('display','block');
        })
        //
        var f1=true;
        $('.color span').click(function(){
            if(f1){
                $(".color span").eq($(this).index()-1).css('background','#999999').
                        siblings('span').css('background','#E6E6E6');
                f1=false;
            }
            else{
                $(".color span").eq($(this).index()-1).css('background','#E6E6E6');
                f1=true;
            }
        })
        var f2=true;
        $('.memory span').click(function(){
            if(f2){
                $(".memory span").eq($(this).index()-1).css('background','#999999').
                        siblings('span').css('background','#E6E6E6');
                f2=false;
            }
            else{
                $(".memory span").eq($(this).index()-1).css('background','#E6E6E6');
                f2=true;
            }
        })
    })
</script>
</body>
</html>